var iframeElm,videoElm,sourceElm;
var tokens;
jQuery(document).ready(function(){
    console.log('ready');
    iframeElm = document.createElement('iframe');
    iframeElm.id="iframePDF";
    iframeElm.width="100%";
    iframeElm.height="600px";

    videoElm = document.createElement('video');
    sourceElm = document.createElement('source');
	videoElm.appendChild(sourceElm);
    videoElm.style.width="100%";
	videoElm.setAttribute('controls','controls');
    
});


function pm(btn,id){
    btn.parentNode.parentNode.parentNode.nextElementSibling.firstElementChild.innerHTML = '';
    btn.parentNode.parentNode.parentNode.nextElementSibling.firstElementChild.appendChild(videoElm);
    
	token = getT(id);
    
    sourceElm.setAttribute('src', "/student/attachment/stream/"+token);
    sourceElm.setAttribute('type', "video/mp4");
    videoElm.load();
    videoElm.play();
}

function rp(btn,id){
    btn.parentNode.parentNode.parentNode.nextElementSibling.firstElementChild.innerHTML = '';
    btn.parentNode.parentNode.parentNode.nextElementSibling.firstElementChild.appendChild(iframeElm);
    token = getT(id);
    iframeElm.src = "/laraview/#../student/attachment/stream/"+token;
    
}

function getT(attachmentid){
    token = '';
    if(tokens != undefined && tokens[attachmentid] != undefined){
        token = tokens[attachmentid].pop();
    }
    return token;
}

function lib(tokenstr){
    tokens = window.atob(tokenstr);
    tokens = JSON.parse(tokens);
    
}